# Splunk搜索语法入门

## 搜索命令入门
在搜索管道的开头，search 命令是隐含的，尽管没有显示指定该命令。如果输入
host=webserver*
和输入的是
search host=webserver* 是一样的

使用关键字、短语、字段、布尔表达式和比较表达式来准确指定想要从 Splunk 索引检索的事件。

## 关键词和短语
默认情况下，当您使用关键字和短语进行搜索时，Splunk 软件会通过匹配数据中的原始事件字段 _raw来检索事件。开始添加搜索调节器（如 _time 和 tag 等字段）时，还可对 _raw 字段中提取的信息进行匹配。

搜索包含关键字和带引号的短语（或任何非搜索调节器内容）的字符串时，Splunk 软件会在 _raw 字段中搜索匹配的事件或结果。下面是关键字和短语的一些示例：
web
error
web error
"web error"
请注意，搜索加有引号的短语 "web error"与不加引号时的搜索不同。搜索 web error 时，Splunk 软件会返回包含 "web" 和"error" 的事件。搜索 "web error" 时，Splunk 软件只返回包含短语 "web error" 的事件。
## 文件路径
要搜索文件路径，如 D:\Digital\RTFM，您只需在搜索中指定文件路径即可。您不需要将短语用引号引起来，也不需要转义任何字符。原因是什么？因为该短语仅包含较小的分隔符，如冒号 ( : ) 和反斜杠 ( \ )。
但是，如果文件路径包含空格，则必须用引号引起来。例如：
```
"D:\Digital\RTFM Backup Folder"
```
空格在数据中视为一个主要分隔符。
## 通配符
可以在字符串中使用星号 ( * ) 字符作为通配符来匹配无限数量的字符。例如，"my*" 可以匹配 myhost1 和myhost.ny.mydomain.com。

### 确保效率
如果指定的星号没有其他条件，那么就会变成与所有字符匹配。检索所有的事件，直到达到最大的限制。匹配所有的字符，这样的搜索既没有效率又很费时。同时也会占用大量的系统资源。这可能导致让其他使用者无法进行搜索，此外还可能需要等待很长的时间获得搜索结果。
为避免上述的问题，需要确保我们的搜索条件尽可能的具体。

### 特定
术语越具体，搜索效率越高。这意味着不使用通配符。搜索特定的单词或者短语比使用通配符的搜索更有效率。比如搜索“wei dong”将始终优于搜索“wei*”。

### 使用通配符的最佳实践
使用通配符的最佳方式是用在术语的末尾处，如“fali*”。
尽可能指定一个字段-值对，比避免搜索整个事件。例如：status=“fail*”。

### 何时避免使用通配符
有几种情况下要避免使用通配符。
- 避免在字符串中间使用通配符
- 避免使用通配符来匹配标点符号
- 避免将通配符用作前缀。使用前缀通配符几乎就像是单独使用通配符一样，前缀通配符可能产生性能问题。
- 搜索星号字符。不能直接搜索星号字符，该字符保留为通配符。
### 其他支持的通配符
like功能支持使用其他通配符进行模糊匹配。百分号用作匹配多个字符的通配符。下划线字符用于匹配单个字符。

## 布尔表达式
Splunk 搜索处理语言 (SPL) 支持布尔运算符：AND、OR 和 NOT。
运算符必须大写。
两个词之间始终隐含有 AND 运算符，即：web error 与 web AND error相同。所以有明确的理由将其包括在内，否则您不需要指定AND运算符。
NOT运算符仅适用于紧随NOT之后的术语。要运用于多个术语，则必须用括号把这些术语括起来。
包含搜索通常将优于排除搜索。搜索 "access denied" 在生成结果时要快于搜索 NOT "access granted"。

